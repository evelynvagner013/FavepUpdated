<app-menu-cima></app-menu-cima>

<div class="password-container">
  <div class="password-box">
    
    <h2 *ngIf="mode === 'verify'">Verifique seu E-mail</h2>
    <h2 *ngIf="mode === 'reset'">Crie sua Nova Senha</h2>

    <p *ngIf="mode === 'verify'">
      Enviamos um código de 6 dígitos para o seu e-mail. Por favor, insira-o abaixo para ativar sua conta.
    </p>
    <p *ngIf="mode === 'reset'">
      Por favor, insira e confirme sua nova senha.
    </p>

    <div *ngIf="successMessage" class="alert alert-success">
      {{ successMessage }} Redirecionando para o login...
    </div>
    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">

      <ng-container *ngIf="mode === 'verify'">
        <div class="form-group">
          <label for="email">E-mail</label>
          <input type="email" id="email" class="form-control" formControlName="email">
          <div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="invalid-feedback">
            <span *ngIf="form.get('email')?.errors?.['required']">E-mail é obrigatório.</span>
            <span *ngIf="form.get('email')?.errors?.['email']">E-mail inválido.</span>
          </div>
        </div>

        <div class="form-group">
          <label for="code">Código de 6 dígitos</label>
          <input type="text" id="code" class="form-control" formControlName="code">
          <div *ngIf="form.get('code')?.invalid && form.get('code')?.touched" class="invalid-feedback">
            <span *ngIf="form.get('code')?.errors?.['required']">Código é obrigatório.</span>
            <span *ngIf="form.get('code')?.errors?.['minlength'] || form.get('code')?.errors?.['maxlength']">
              O código deve ter 6 dígitos.
            </span>
          </div>
        </div>
      </ng-container>

      <ng-container *ngIf="mode === 'reset'">
        <div class="form-group">
          <label for="senha">Nova Senha</label>
          <input type="password" id="senha" class="form-control" formControlName="senha">
          <div *ngIf="form.get('senha')?.invalid && form.get('senha')?.touched" class="invalid-feedback">
            <span *ngIf="form.get('senha')?.errors?.['required']">Senha é obrigatória.</span>
            <span *ngIf="form.get('senha')?.errors?.['minlength']">Senha deve ter no mínimo 6 caracteres.</span>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmarSenha">Confirmar Nova Senha</label>
          <input type="password" id="confirmarSenha" class="form-control" formControlName="confirmarSenha">
          <div *ngIf="form.get('confirmarSenha')?.invalid && form.get('confirmarSenha')?.touched" class="invalid-feedback">
            <span *ngIf="form.get('confirmarSenha')?.errors?.['required']">Confirmação é obrigatória.</span>
          </div>
          <div *ngIf="form.errors?.['mismatch'] && form.get('confirmarSenha')?.touched" class="invalid-feedback">
            As senhas não coincidem.
          </div>
        </div>
      </ng-container>

      <button type="submit" class="btn-submit" [disabled]="isLoading">
        <span *ngIf="!isLoading && mode === 'verify'">Verificar Conta</span>
        <span *ngIf="!isLoading && mode === 'reset'">Salvar Nova Senha</span>
        <span *ngIf="isLoading">Aguarde...</span>
      </button>

    </form>
  </div>
</div>

<app-footer></app-footer>